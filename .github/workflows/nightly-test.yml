name: Nightly Test

on:
  schedule:
    - cron: '0 18 * * *' # KST 3ì‹œ (í•œêµ­ ìƒˆë²½ 3ì‹œ)

jobs:
  nightly-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install dependencies
        run: pip install -r ./pick-habju-backend/requirements.txt
      - name: Run tests
        run: pytest

      - name: Discord ì•Œë¦¼ # í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ì‹œë§Œ
        if: failure()
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK }}
          message: |
            ğŸš¨ **Nightly Test ì‹¤íŒ¨**
            ì›Œí¬í”Œë¡œìš°: ${{ github.workflow }}
            ë¸Œëœì¹˜: ${{ github.ref }}
            ì»¤ë°‹: ${{ github.sha }}
            ìì„¸í•œ ë‚´ìš©ì€: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
